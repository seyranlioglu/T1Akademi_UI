<div class="content-library-container">
    
    <!-- Search Bar -->
    <div class="search-bar mb-3">
        <div class="input-group">
            <input type="text" class="form-control" placeholder="Dosya ara..." 
                   [(ngModel)]="searchText" (keyup.enter)="onSearch()">
            <button class="btn btn-outline-primary" type="button" (click)="onSearch()">
                <i class='bx bx-search'></i> Ara
            </button>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid" *ngIf="!isLoading; else loadingTemplate">
        <div class="row" *ngIf="contents.length > 0; else noDataTemplate">
            <div class="col-md-3 col-6 mb-4" *ngFor="let item of contents">
                <div class="library-item" 
                     [class.selected]="selectedItem?.id === item.id"
                     (click)="selectItem(item)">
                    
                    <!-- Görsel Önizleme -->
                    <div class="item-preview">
                        <!-- Eğer resimse göster, değilse ikon göster -->
                        <img *ngIf="item.contentType?.includes('image') || item.fileName.endsWith('.jpg') || item.fileName.endsWith('.png')" 
                             [src]="item.filePath" 
                             alt="{{item.fileName}}">
                        
                        <div *ngIf="!(item.contentType?.includes('image') || item.fileName.endsWith('.jpg') || item.fileName.endsWith('.png'))" 
                             class="file-icon">
                             <i class='bx bx-file'></i>
                        </div>
                    </div>

                    <div class="item-info">
                        <small>{{ item.fileName }}</small>
                    </div>
                    
                    <div class="selected-overlay" *ngIf="selectedItem?.id === item.id">
                        <i class='bx bx-check'></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pagination (Basit) -->
        <div class="pagination-area text-center" *ngIf="totalItems > pageSize">
            <button class="btn btn-sm btn-light me-2" 
                    [disabled]="currentPage === 1" 
                    (click)="onPageChange(currentPage - 1)">Önceki</button>
            <span>Sayfa {{currentPage}}</span>
            <button class="btn btn-sm btn-light ms-2" 
                    [disabled]="contents.length < pageSize" 
                    (click)="onPageChange(currentPage + 1)">Sonraki</button>
        </div>
    </div>

    <!-- Actions -->
    <div class="modal-footer-actions mt-3 text-end">
        <button class="btn btn-secondary me-2" (click)="cancel()">İptal</button>
        <button class="btn btn-primary" (click)="confirmSelection()" [disabled]="!selectedItem">
            Seç
        </button>
    </div>

    <!-- Templates -->
    <ng-template #loadingTemplate>
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Yükleniyor...</span>
            </div>
        </div>
    </ng-template>

    <ng-template #noDataTemplate>
        <div class="text-center py-5 text-muted">
            <i class='bx bx-folder-open fs-1'></i>
            <p>İçerik bulunamadı.</p>
        </div>
    </ng-template>
</div>
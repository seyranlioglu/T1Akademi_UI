<div class="forgot-password-wizard p-2">
    
    <div class="text-center mb-4">
        <h4 class="fw-bold">Şifremi Unuttum</h4>
        <p class="text-muted small mb-0" *ngIf="currentStep === 1">Hesabınızı bulmamıza yardımcı olun.</p>
        <p class="text-muted small mb-0" *ngIf="currentStep === 2">Doğrulama kodunu giriniz.</p>
        <p class="text-muted small mb-0" *ngIf="currentStep === 3">Yeni şifrenizi belirleyin.</p>
    </div>

    <div *ngIf="errorMessage" class="alert alert-danger py-2 small mb-3">
        <i class='bx bx-error-circle me-1'></i> {{ errorMessage }}
    </div>
    
    <div *ngIf="successMessage && !errorMessage" class="alert alert-success py-2 small mb-3">
        <i class='bx bx-check-circle me-1'></i> {{ successMessage }}
    </div>

    <div *ngIf="currentStep === 1" class="fade-in">
        <div class="form-group mb-3">
            <label class="small fw-bold text-muted mb-1">E-Posta veya Telefon</label>
            <div class="input-group">
                <span class="input-group-text bg-light border-end-0"><i class='bx bx-user'></i></span>
                
                <input type="text" class="form-control border-start-0 ps-0" 
                       [(ngModel)]="formData.emailOrPhone" 
                       (input)="onDynamicInput($event)"
                       placeholder="5XX XXX XX XX veya e-posta"
                       (keyup.enter)="sendCode()">
                       
            </div>
        </div>
        <button class="btn btn-primary w-100 mb-2" (click)="sendCode()" [disabled]="isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            {{ isLoading ? 'Gönderiliyor...' : 'Doğrulama Kodu Gönder' }}
        </button>
    </div>

    <div *ngIf="currentStep === 2" class="fade-in text-center">
        <div class="mb-3">
            <span class="badge bg-light text-dark border px-3 py-2 rounded-pill">{{ formData.emailOrPhone }}</span>
        </div>
        <div class="form-group mb-4">
            <input type="text" class="form-control text-center fs-3 fw-bold letter-spacing-lg" 
                   [(ngModel)]="formData.code" 
                   placeholder="____" maxlength="4"
                   style="letter-spacing: 5px;">
            <small class="text-muted">Lütfen gelen 4 haneli kodu giriniz.</small>
        </div>
        <button class="btn btn-primary w-100 mb-2" (click)="verifyCode()" [disabled]="isLoading">
            {{ isLoading ? 'Kontrol Ediliyor...' : 'Onayla ve Devam Et' }}
        </button>
        <button class="btn btn-link text-muted small text-decoration-none" (click)="currentStep = 1">Geri Dön</button>
    </div>

    <div *ngIf="currentStep === 3" class="fade-in">
        <div class="form-group mb-3">
            <label class="small fw-bold text-muted">Yeni Şifre</label>
            <input type="password" class="form-control" [(ngModel)]="formData.password" placeholder="Yeni şifreniz">
        </div>
        <div class="form-group mb-4">
            <label class="small fw-bold text-muted">Yeni Şifre (Tekrar)</label>
            <input type="password" class="form-control" [(ngModel)]="formData.confirmPassword" placeholder="Şifrenizi doğrulayın">
        </div>
        <button class="btn btn-success w-100 mb-2" (click)="resetPassword()" [disabled]="isLoading">
            {{ isLoading ? 'Güncelleniyor...' : 'Şifreyi Değiştir' }}
        </button>
    </div>

    <div class="text-center mt-2" *ngIf="currentStep === 1">
        <button class="btn btn-link text-secondary small text-decoration-none" (click)="onCancel()">Vazgeç</button>
    </div>
</div>